
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>文档编辑器demo</title>
<meta content="IE=11" http-equiv="X-UA-Compatible" charset="UTF-8"/> <!-- TODO bird 这里可能需要调整 -->
		<!--设置缓存-->
		<meta http-equiv="cache-control" content="no-cache,must-revalidate">
		<meta http-equiv="pragram" content="no-cache">
		<meta http-equiv="expires" content="0">
    <link href="StyleSheet.css" rel="stylesheet" type="text/css" />
   <script type="text/javascript" src="OfficeContorlFunctions.js"></script>
   <script type="text/javascript">
   		var id = "123233";
   </script>
</head>
<body  onload='intializePage(id)' onbeforeunload ="onPageClose()"><!-- TODO bird 两个事件需要注意一下 -->
<div id="editmain" class="editmain">
                <div id="officecontrol">
                <script type="text/javascript" src="http://www.ntko.com/control/officecontrol/ntkoofficecontrol.js"></script>
                <div id=statusBar style="height:20px;width:100%;background-color:#c0c0c0;font-size:12px;"></div>

               			 <!-- js配置项 开始-->
								<script language="JScript" for=TANGER_OCX event="OnDocumentClosed()">
									setFileOpenedOrClosed(false);
								</script>
								<script language="JScript" for="TANGER_OCX" event="OnDocumentOpened(TANGER_OCX_str,TANGER_OCX_obj)">

									OFFICE_CONTROL_OBJ.activeDocument.saved=true;//saved属性用来判断文档是否被修改过,文档打开的时候设置成ture,当文档被修改,自动被设置为false,该属性由office提供.
									//获取文档控件中打开的文档的文档类型
									switch (OFFICE_CONTROL_OBJ.doctype)
									{
										case 1:
											fileType = "Word.Document";
											fileTypeSimple = "wrod";
											break;
										case 2:
											fileType = "Excel.Sheet";
											fileTypeSimple="excel";
											break;
										case 3:
											fileType = "PowerPoint.Show";
											fileTypeSimple = "ppt";
											break;
										case 4:
											fileType = "Visio.Drawing";
											break;
										case 5:
											fileType = "MSProject.Project";
											break;
										case 6:
											fileType = "WPS Doc";
											fileTypeSimple="wps";
											break;
										case 7:
											fileType = "Kingsoft Sheet";
											fileTypeSimple="et";
											break;
										default :
											fileType = "unkownfiletype";
											fileTypeSimple="unkownfiletype";
									}
									setFileOpenedOrClosed(true);
								</script>
								<!-- 自定义按钮事件 -->
								<script language="javascript" for="TANGER_OCX" event="OnCustomToolBarCommand(btnIdx)">
								switch (btnIdx)
								{
									case 0://保存
										saveFileToUrl();
										break;
									case 1://保存到本地
										OFFICE_CONTROL_OBJ.SaveToLocal(ShowDialog(3));
										break;
									case 2://打印
										OFFICE_CONTROL_OBJ.PrintPreview();
										break;
									case 3://隐藏痕迹
										toggleRevisions(btnIdx,4);
										break;
									case 4://显示痕迹
										toggleRevisions(btnIdx,3);
										break;
									case 5://打开文件
										OFFICE_CONTROL_OBJ.OpenLocalFile(ShowDialog(1));
										break;
									case 6://全屏
										toggleFullScreenMode(btnIdx,7);
										break;
									case 7://退出全屏
										toggleFullScreenMode(btnIdx,6);
										break;
									case 8://打开修订
										toggleReviewMode(btnIdx,9);
										break;
									case 9://退出修订
										toggleReviewMode(btnIdx,8);
										break;
									default :
										console.log("没有对应功能！");
								}
								</script>
								<script language="JScript" for=TANGER_OCX event="OnFileCommand(TANGER_OCX_str,TANGER_OCX_obj)">
									if (TANGER_OCX_str == 3)
									{
										alert("不能保存！");
										CancelLastCommand = true;
									}
								</script>
								<script language="JScript" for=TANGER_OCX event="AfterPublishAsPDFToURL(result,code)">
									result=trim(result);
									alert(result);
									document.all("statusBar").innerHTML="服务器返回信息:"+result;
									if(result=="文档保存成功。")
									{window.close();}
								</script>
								<script language="JScript" for=TANGER_OCX event="OnCustomMenuCmd2(menuPos,submenuPos,subsubmenuPos,menuCaption,menuID)">
								alert("第" + menuPos +","+ submenuPos +","+ subsubmenuPos +"个菜单项,menuID="+menuID+",菜单标题为\""+menuCaption+"\"的命令被执行.");
								</script>
								<!-- js配置项完毕 -->
                </div>
       <div id="edit_bottom" class="edit_bottom">
       <img alt="" src="images/edit_main_nether.jpg" />
           <div id="conmpanyinfo" class="conmpanyinfo">
            <img alt="重庆软航科技有限公司" src="images/Companyinfo.jpg" />
             <p>技术支持详见公司网站www.ntko.com “联系我们”</p>
            </div>
        </div>
    </div>
</body>
</html>
