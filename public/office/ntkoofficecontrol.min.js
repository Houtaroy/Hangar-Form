/*------------------------------------------------------*/
/*                   修改控件的配置信息                                                                    */
/*                   version:2.1.0                      */
/*                                           */
/*------------------------------------------------------*/
//设置高度
var height="1000px";
//设置宽度
var width="700px";


/*
谷歌浏览器事件接管但此接管事件只支持低版本的谷歌（45以下版本不包含45）和火狐（52以下版本不包含52）
*/
function ntkosavetourl(type,code,html)
{
	//alert("SaveToURL成功回调");
    console.log("SaveToURL成功回调");	
}


function ntkopublishashtml(type,code,html){
	//alert("Onpublishashtmltourl成功回调");
}
function ntkopublishaspdf(type,code,html){
//alert("Onpublishaspdftourl成功回调");
}
function ntkosaveasotherurl(type,code,html){
//alert("SaveAsOtherformattourl成功回调");
}

function ntkoondocumentopened(type,code){
	//alert("Ondocumentopened成功回调");
       console.log("Ondocumentopened成功回调");

}




/*------------------------------------------------------*/
/*             以下内容 请勿修改，否则可能出错                                                              */
/*------------------------------------------------------*/

	var userAgent = navigator.userAgent, 
				rMsie = /(msie\s|trident.*rv:)([\w.]+)/, 
				rFirefox = /(firefox)\/([\w.]+)/, 
				rOpera = /(opera).+version\/([\w.]+)/, 
				rChrome = /(chrome)\/([\w.]+)/, 
				rSafari = /version\/([\w.]+).*(safari)/;
				var browser;
				var version;
				var ua = userAgent.toLowerCase();
				function uaMatch(ua) {
					var match = rMsie.exec(ua);
					if (match != null) {
						return { browser : "IE", version : match[2] || "0" };
					}
					var match = rFirefox.exec(ua);
					if (match != null) {
						return { browser : match[1] || "", version : match[2] || "0" };
					}
					var match = rOpera.exec(ua);
					if (match != null) {
						return { browser : match[1] || "", version : match[2] || "0" };
					}
					var match = rChrome.exec(ua);
					if (match != null) {
						return { browser : match[1] || "", version : match[2] || "0" };
					}
					var match = rSafari.exec(ua);
					if (match != null) {
						return { browser : match[2] || "", version : match[1] || "0" };
					}
					if (match != null) {
						return { browser : "", version : "0" };
					}
				}
				var browserMatch = uaMatch(userAgent.toLowerCase());
				if (browserMatch.browser) {
					browser = browserMatch.browser;
					version = browserMatch.version;
				}
				

 if (browser=="firefox"){ 
         
		
		
		
		document.write('<object  name="webwps" id="TANGER_OCX" type="application/ntko-plug"  height="'+width+'" width="'+height+'" ForOnDocumentOpened = "ntkoondocumentopened"  ');
        document.write('ForOnSaveToURL="ntkosavetourl" ForOnDocumentClosed="OnDocumentClosed" ForOnAfterOpenFromURLCallBack="OnAfterOpenFromURLCallBack" ForOnBeginOpenFromURL="OnBeginOpenFromURL"');
        document.write('ForOnCustomMenuCmd2="OnCustomMenuCmd2" ForOnCustomToolBarCommand="OnCustomToolBarCommand" ForOnCustomButtonOnMenuCmd="OnCustomButtonOnMenuCmd"');
        document.write('ForOnFileCommand="OnFileCommand" ForOnCustomFileMenuCmd="OnCustomFileMenuCmd" ForOnScreenModeChanged="OnScreenModeChanged"');
        document.write('ForOnWordBeforeRightClick="OnWordBeforeRightClick" ForOnSheetBeforeDoubleClick="OnSheetBeforeDoubleClick"');
        document.write('<SPAN STYLE="color:red">不能装载文档控件。请检查文档控件是否已经正确安装</SPAN> 请点击<a href="ntkoplugins.crx">安装组件</a></object>');

}else if(browser=="chrome"){
		document.write('<object  name="webwps" id="TANGER_OCX" type="application/ntko-plug"  height="'+width+'" width="'+height+'" ForOnDocumentOpened = "ntkoondocumentopened"  ');
        document.write('ForOnSaveToURL="ntkosavetourl" ForOnDocumentClosed="OnDocumentClosed" ForOnAfterOpenFromURLCallBack="OnAfterOpenFromURLCallBack" ForOnBeginOpenFromURL="OnBeginOpenFromURL"');
        document.write('ForOnCustomMenuCmd2="OnCustomMenuCmd2" ForOnCustomToolBarCommand="OnCustomToolBarCommand" ForOnCustomButtonOnMenuCmd="OnCustomButtonOnMenuCmd"');
        document.write('ForOnFileCommand="OnFileCommand" ForOnCustomFileMenuCmd="OnCustomFileMenuCmd" ForOnScreenModeChanged="OnScreenModeChanged"');
        document.write('ForOnWordBeforeRightClick="OnWordBeforeRightClick" ForOnSheetBeforeDoubleClick="OnSheetBeforeDoubleClick"');
        document.write('<SPAN STYLE="color:red">不能装载文档控件。请检查文档控件是否已经正确安装</SPAN> 请点击<a href="ntkoplugins.crx">安装组件</a></object>');
     
	}else if (Sys.opera){
		alert("sorry,ntko web印章暂时不支持opera!");
	}else if (Sys.safari){
		 alert("sorry,ntko web印章暂时不支持safari!");
	}
